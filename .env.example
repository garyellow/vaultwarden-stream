# =============================================================================
# Vaultwarden Stream — Environment Configuration
# =============================================================================
#
# Quick Start:
#   1. Copy:       cp .env.example .env
#   2. Fill in:    S3_BUCKET, S3_ENDPOINT, S3_ACCESS_KEY_ID, S3_SECRET_ACCESS_KEY
#   3. Deploy:     docker compose up -d
#
# Formatting:
#   • KEY=value   → active (required or commonly used)
#   • # KEY=value → optional (disabled by default)
#
# =============================================================================


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  REQUIRED — S3-Compatible Storage                                         ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## S3 provider name (for rclone). Full list: https://rclone.org/s3/#s3-provider
## Examples: Cloudflare, AWS, Minio, Backblaze, DigitalOcean, Wasabi
S3_PROVIDER=Cloudflare

## S3 bucket name for backups.
S3_BUCKET=

## S3 endpoint URL.
## - Cloudflare R2:  https://<ACCOUNT_ID>.r2.cloudflarestorage.com
## - AWS S3:         https://s3.<REGION>.amazonaws.com
## - MinIO:          https://minio.example.com
## - Backblaze B2:   https://s3.<REGION>.backblazeb2.com
S3_ENDPOINT=

## S3 access credentials (shared by Litestream and rclone).
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  OPTIONAL — S3 Advanced Settings                                          ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## Path prefix in bucket (auto-normalized, no leading/trailing slashes).
# S3_PREFIX=vaultwarden

## S3 region. Use "auto" for Cloudflare R2.
# S3_REGION=auto

## Canned ACL for uploaded objects.
# S3_ACL=private


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  OPTIONAL — Deployment Configuration                                      ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## Node role: primary (main) | secondary (DR standby).
# NODE_ROLE=primary

## Deployment mode: persistent (long-running) | serverless (scale-to-zero).
## Primary:   no code difference between modes
## Secondary: serverless skips periodic refresh (restores from S3 at cold start)
# DEPLOYMENT_MODE=persistent

## PRIMARY: how often to upload non-DB files to S3 (seconds).
# PRIMARY_SYNC_INTERVAL=300

## SECONDARY: how often to refresh all data from S3 (seconds, persistent mode only).
# SECONDARY_SYNC_INTERVAL=3600

## Health check: max seconds since last sync before marking unhealthy.
# HEALTHCHECK_SYNC_MAX_AGE=600


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  OPTIONAL — Litestream (Database Replication)                             ║
# ║  Docs: https://litestream.io/reference/config/                            ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## How often to push WAL frames to S3 (PRIMARY only).
# LITESTREAM_SYNC_INTERVAL=1s

## How often to create full database snapshots.
# LITESTREAM_SNAPSHOT_INTERVAL=30m

## Snapshot retention period.
# LITESTREAM_RETENTION=24h

## SQLite database path inside container.
# LITESTREAM_DB_PATH=/data/db.sqlite3

## Database replica path in S3 (auto-derived from S3_PREFIX if unset).
# LITESTREAM_REPLICA_PATH=vaultwarden/db.sqlite3


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  OPTIONAL — rclone (File Sync)                                            ║
# ║  Docs: https://rclone.org/s3/                                             ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## rclone remote name (alphanumeric and underscores only).
# RCLONE_REMOTE_NAME=S3

## Extra flags for rclone commands.
## Examples: --verbose, --log-file=/tmp/rclone.log, --bwlimit=1M
# RCLONE_FLAGS=


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  OPTIONAL — Vaultwarden                                                   ║
# ║  Docs: https://github.com/dani-garcia/vaultwarden/wiki/                   ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

## Public URL (required for email links, WebAuthn, push notifications).
# DOMAIN=https://vault.example.com

## Admin panel token (unset = disabled).
## Generate: docker run --rm vaultwarden/server /vaultwarden hash --preset owasp
# ADMIN_TOKEN=

# SIGNUPS_ALLOWED=true
# SIGNUPS_VERIFY=false
# SIGNUPS_DOMAINS_WHITELIST=
# INVITATIONS_ALLOWED=true

## WebSocket for realtime sync. For serverless, set false to eliminate periodic wake-ups.
## When disabled, clients use 30-minute polling instead.
# ENABLE_WEBSOCKET=true

# WEB_VAULT_ENABLED=true


## ── SMTP ──────────────────────────────────────────────────────────────────
## Required for email verification, invitations, 2FA, and alerts.

# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_SECURITY=starttls
# SMTP_USERNAME=
# SMTP_PASSWORD=
# SMTP_FROM=vaultwarden@example.com
# SMTP_FROM_NAME=Vaultwarden
# SMTP_TIMEOUT=15
# SMTP_EMBED_IMAGES=true
# SMTP_ACCEPT_INVALID_CERTS=false


## ── Push Notifications ────────────────────────────────────────────────────
## Register at https://bitwarden.com/host/ for installation ID & key.

# PUSH_ENABLED=false
# PUSH_INSTALLATION_ID=
# PUSH_INSTALLATION_KEY=
# PUSH_RELAY_URI=https://push.bitwarden.com
# PUSH_IDENTITY_URI=https://identity.bitwarden.com


## ── Security & Rate Limiting ──────────────────────────────────────────────

# LOGIN_RATELIMIT_SECONDS=60
# LOGIN_RATELIMIT_MAX_BURST=10
# ADMIN_RATELIMIT_SECONDS=300
# ADMIN_RATELIMIT_MAX_BURST=3
# ADMIN_SESSION_LIFETIME=20
# PASSWORD_ITERATIONS=600000
# DISABLE_2FA_REMEMBER=false
# REQUIRE_DEVICE_EMAIL=false
# IP_HEADER=X-Real-IP


## ── Logging ───────────────────────────────────────────────────────────────

# LOG_LEVEL=info
# EXTENDED_LOGGING=true
# LOG_TIMESTAMP_FORMAT=%Y-%m-%d %H:%M:%S.%3f
# LOG_FILE=


## ── Miscellaneous ─────────────────────────────────────────────────────────

# SENDS_ALLOWED=true
# EMERGENCY_ACCESS_ALLOWED=true
# EMAIL_CHANGE_ALLOWED=true
# ORG_EVENTS_ENABLED=false
# TRASH_AUTO_DELETE_DAYS=
# HIBP_API_KEY=
# SHOW_PASSWORD_HINT=false
# TZ=UTC
# ROCKET_PORT=80
# ROCKET_ADDRESS=0.0.0.0


## ── SSO / OpenID Connect (1.32.0+) ────────────────────────────────────────

# SSO_ENABLED=false
# SSO_ONLY=false
# SSO_AUTHORITY=
# SSO_CLIENT_ID=
# SSO_CLIENT_SECRET=
# SSO_SCOPES=email profile
# SSO_PKCE=true


## ── YubiKey 2FA ───────────────────────────────────────────────────────────

# YUBICO_CLIENT_ID=
# YUBICO_SECRET_KEY=
# YUBICO_SERVER=


## ── Duo 2FA ───────────────────────────────────────────────────────────────

# DUO_IKEY=
# DUO_SKEY=
# DUO_HOST=
