# ===========================================================================
# Vaultwarden Stream — Environment Configuration
# ===========================================================================
#
# Quick Start:
#   1. cp .env.example .env
#   2. Fill in S3_BUCKET, S3_ENDPOINT, S3_ACCESS_KEY_ID, S3_SECRET_ACCESS_KEY
#   3. docker compose up -d
#
# KEY=value  → active     |   # KEY=value  → optional (disabled)
#
# ===========================================================================


# ── Required — S3-Compatible Storage ───────────────────────────────────────

## S3 provider (for rclone): Cloudflare, AWS, Minio, Backblaze, etc.
## Full list: https://rclone.org/s3/#s3-provider
S3_PROVIDER=Cloudflare

## S3 bucket name.
S3_BUCKET=

## S3 endpoint URL.
## Cloudflare R2:  https://<ACCOUNT_ID>.r2.cloudflarestorage.com
## AWS S3:         https://s3.<REGION>.amazonaws.com
## MinIO:          https://minio.example.com
S3_ENDPOINT=

## S3 credentials (shared by Litestream and rclone).
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=


# ── Optional — S3 ──────────────────────────────────────────────────────────

# S3_PREFIX=vaultwarden
# S3_REGION=auto
# S3_ACL=private


# ── Optional — Deployment ──────────────────────────────────────────────────

## primary = main instance | secondary = DR standby
# NODE_ROLE=primary

## persistent = long-running | serverless = scale-to-zero
# DEPLOYMENT_MODE=persistent

## File upload interval in seconds (primary only).
# PRIMARY_SYNC_INTERVAL=300

## Data refresh interval in seconds (secondary persistent only).
# SECONDARY_SYNC_INTERVAL=3600

# HEALTHCHECK_SYNC_MAX_AGE=600


# ── Optional — Snapshot Backup ─────────────────────────────────────────────

## Periodic tar.gz backup of database + files to S3 (primary only).
## Not recommended for serverless (prevents scale-to-zero).
# BACKUP_ENABLED=false
# BACKUP_INTERVAL=86400
# BACKUP_RETENTION_DAYS=30


# ── Optional — Litestream ──────────────────────────────────────────────────
## Docs: https://litestream.io/reference/config/

# LITESTREAM_SYNC_INTERVAL=1s
# LITESTREAM_SNAPSHOT_INTERVAL=30m
# LITESTREAM_RETENTION=24h
# LITESTREAM_DB_PATH=/data/db.sqlite3
# LITESTREAM_REPLICA_PATH=vaultwarden/db.sqlite3


# ── Optional — rclone ──────────────────────────────────────────────────────
## Docs: https://rclone.org/s3/

# RCLONE_REMOTE_NAME=S3
# RCLONE_FLAGS=


# ── Optional — Vaultwarden ─────────────────────────────────────────────────
## Docs: https://github.com/dani-garcia/vaultwarden/wiki/

# DOMAIN=https://vault.example.com

## Generate: docker run --rm vaultwarden/server /vaultwarden hash --preset owasp
# ADMIN_TOKEN=

# SIGNUPS_ALLOWED=true
# SIGNUPS_VERIFY=false
# SIGNUPS_DOMAINS_WHITELIST=
# INVITATIONS_ALLOWED=true

## Disable for serverless to allow scale-to-zero (clients poll every 30min).
# ENABLE_WEBSOCKET=true

# WEB_VAULT_ENABLED=true


# ── SMTP ───────────────────────────────────────────────────────────────────

# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_SECURITY=starttls
# SMTP_USERNAME=
# SMTP_PASSWORD=
# SMTP_FROM=vaultwarden@example.com
# SMTP_FROM_NAME=Vaultwarden
# SMTP_TIMEOUT=15
# SMTP_EMBED_IMAGES=true
# SMTP_ACCEPT_INVALID_CERTS=false


# ── Push Notifications ─────────────────────────────────────────────────────
## Register at https://bitwarden.com/host/

# PUSH_ENABLED=false
# PUSH_INSTALLATION_ID=
# PUSH_INSTALLATION_KEY=
# PUSH_RELAY_URI=https://push.bitwarden.com
# PUSH_IDENTITY_URI=https://identity.bitwarden.com


# ── Security & Rate Limiting ───────────────────────────────────────────────

# LOGIN_RATELIMIT_SECONDS=60
# LOGIN_RATELIMIT_MAX_BURST=10
# ADMIN_RATELIMIT_SECONDS=300
# ADMIN_RATELIMIT_MAX_BURST=3
# ADMIN_SESSION_LIFETIME=20
# PASSWORD_ITERATIONS=600000
# DISABLE_2FA_REMEMBER=false
# REQUIRE_DEVICE_EMAIL=false
# IP_HEADER=X-Real-IP


# ── Logging ────────────────────────────────────────────────────────────────

# LOG_LEVEL=info
# EXTENDED_LOGGING=true
# LOG_TIMESTAMP_FORMAT=%Y-%m-%d %H:%M:%S.%3f
# LOG_FILE=


# ── Miscellaneous ──────────────────────────────────────────────────────────

# SENDS_ALLOWED=true
# EMERGENCY_ACCESS_ALLOWED=true
# EMAIL_CHANGE_ALLOWED=true
# ORG_EVENTS_ENABLED=false
# TRASH_AUTO_DELETE_DAYS=
# HIBP_API_KEY=
# SHOW_PASSWORD_HINT=false
# TZ=UTC
# ROCKET_PORT=80
# ROCKET_ADDRESS=0.0.0.0


# ── SSO / OpenID Connect (1.32.0+) ─────────────────────────────────────────

# SSO_ENABLED=false
# SSO_ONLY=false
# SSO_AUTHORITY=
# SSO_CLIENT_ID=
# SSO_CLIENT_SECRET=
# SSO_SCOPES=email profile
# SSO_PKCE=true


# ── YubiKey 2FA ────────────────────────────────────────────────────────────

# YUBICO_CLIENT_ID=
# YUBICO_SECRET_KEY=
# YUBICO_SERVER=


# ── Duo 2FA ────────────────────────────────────────────────────────────────

# DUO_IKEY=
# DUO_SKEY=
# DUO_HOST=
